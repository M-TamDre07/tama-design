<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Feedback & Penilaian â€” Enhanced Studio v3.0</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* VARS & RESET */
    :root{
      --bg:#0b0b0b; --panel:#121315; --card:#1e2022; --glass: rgba(255,255,255,0.08);
      --accent1:#44d7b6; /* Teal Baru */
      --accent2:#56e39f; 
      --muted:#9aa0a6; --text:#e9f0ef;
      --radius:16px; --shadow: 0 8px 25px rgba(0,0,0,0.7);
      --star-active: #FFD700;
      /* VAR untuk Email Identitas Pengirim (Hapus Lokal Selektif) */
      --sender-email: ''; 
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; background:linear-gradient(180deg, #0b0b0b, #0f1112);
      color:var(--text); font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto; padding:0;
      display:flex; justify-content:center; align-items:flex-start;
      overflow-x: hidden;
    }

    .main-container{ width:100%; max-width:1200px; padding: 20px; }

    /* MARQUEE */
    .promo-strip{
      width:100%; overflow:hidden; white-space:nowrap; 
      background:linear-gradient(90deg, var(--accent1), var(--accent2));
      border-radius:var(--radius); margin-bottom:25px;
      padding:10px 0; box-shadow: 0 4px 15px rgba(68, 215, 182, 0.5);
      line-height: 1.5; display: flex; align-items: center;
    }
    .promo-text {
      display: inline-block; padding-left: 100%;
      animation: marquee 25s linear infinite;
      font-weight: 700; color:#001018; font-size: 1rem;
    }
    @keyframes marquee {
      0% { transform: translate(0, 0); }
      100% { transform: translate(-100%, 0); }
    }
    /* FIX MARQUEE DI HP */
    @media (max-width: 600px) {
        .promo-text {
            font-size: 0.9rem; /* Ukuran teks lebih kecil */
            animation-duration: 15s; /* Kecepatan lebih cepat di layar kecil */
            line-height: 1.2; /* Lebih rapat */
        }
        .promo-strip {
             border-radius: 8px; /* Lebih kecil */
        }
    }


    /* GRID LAYOUT (Desktop) */
    .wrap{
      width:100%; display:grid; grid-template-columns: 2fr 1fr; 
      gap:22px;
    }
    /* Struktur Layout Mobile */
    @media (max-width:980px){
      .wrap{ grid-template-columns: 1fr; }
      .sidebar{ position:relative; top:auto; order: 3; margin-top: 20px; }
      .card-list-reviews { order: 2; margin-top: 20px;} 
      .card-form { order: 1; }
    }

    /* CARD STYLING */
    .card{
      background:var(--card);
      border:1px solid var(--glass); border-radius:var(--radius); 
      padding:25px; box-shadow:var(--shadow);
    }
    .card-list-reviews { 
        grid-column: 1 / span 2; 
    }

    /* FORM ELEMENTS */
    h2{margin:0 0 8px; font-size:1.6rem; color:var(--accent1)}
    .lead{color:var(--muted); margin-bottom:16px; font-size:0.95rem}
    label{display:block; font-weight:600; margin-top:12px; font-size:0.9rem; color:var(--muted)}
    label.required:after{ content:'*'; color:#ff7b92; margin-left:4px }
    
    input[type="text"], input[type="email"], textarea, select{
      width:100%; padding:12px 14px; margin-top:6px; border-radius:10px; border:1px solid rgba(255,255,255,0.15);
      background:var(--panel); color:var(--text); outline:none; font-size:0.95rem;
      transition: border-color 0.3s;
    }
    input:focus, textarea:focus { border-color: var(--accent1); }
    textarea{min-height:110px; resize:vertical}

    /* FIX BINTANG MELEBAR */
    .stars{display:flex; gap:8px; margin-top:8px}
    .star{
        font-size:24px; 
        color:rgba(255,255,255,0.2); 
        cursor:pointer; 
        transition: color .2s, text-shadow .2s;
        padding: 0 2px; 
    }
    .star.hover, .star.active{ 
        color: var(--star-active); 
        text-shadow: 0 0 8px rgba(255, 215, 0, 0.6); 
    }
    .star:before {
        font-family: 'Font Awesome 6 Free'; 
        font-weight: 900; 
        content: '\f005'; 
    }

    /* ACTIONS */
    .actions{display:flex; gap:10px; margin-top:20px; align-items:center}
    button.primary{
      background:linear-gradient(90deg,var(--accent1),var(--accent2)); border:none; color:#001018; padding:12px 18px;
      border-radius:10px; font-weight:800; cursor:pointer; box-shadow: 0 4px 10px rgba(68, 215, 182, 0.4);
      transition: all .2s;
    }
    button.primary:hover:not(:disabled){ transform: translateY(-1px); box-shadow: 0 6px 12px rgba(68, 215, 182, 0.6); }
    button.ghost{
        background:var(--panel); border:1px solid var(--glass); color:var(--text); padding:12px 18px; 
        border-radius:10px; cursor:pointer; transition: background .2s;
    }
    button.ghost:hover{ background: rgba(255,255,255,0.05); }

    /* SIDEBAR (STATS) */
    .sidebar{ position:sticky; top:28px; height:fit-content; display:flex; flex-direction:column; gap:12px }
    .stat-grid{ display:grid; grid-template-columns:repeat(2,1fr); gap:10px }
    .stat{
      padding:15px; border-radius:12px; background:var(--panel); border:1px solid var(--glass);
    }
    .stat .value{font-weight:800; font-size:1.6rem; color:var(--accent2);}

    /* LIST */
    .list{ margin-top:15px; max-height:420px; overflow-y:auto; padding-right:6px }
    .item{
      display:flex; gap:12px; align-items:flex-start; padding:15px; border-radius:12px; margin-bottom:12px;
      background:var(--panel); border:1px solid rgba(255,255,255,0.05);
      animation: fadeIn 0.4s ease-out; 
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .avatar{width:48px; height:48px; border-radius:50%; background:linear-gradient(45deg,var(--accent1),var(--accent2)); 
        display:flex; align-items:center; justify-content:center; font-weight:700; color:#001018; font-size:1.1rem; flex-shrink: 0;
    }
    .meta{flex:1; min-width:0}
    .meta .name{font-weight:700; font-size:1rem}
    .meta .msg{margin-top:6px; color:var(--muted); font-size:0.95rem; line-height:1.4}
    .controls{display:flex; justify-content:space-between; align-items:center; margin-top:8px; border-top:1px dashed rgba(255,255,255,0.05); padding-top:6px;}

    .pill{ padding:6px 10px; border-radius:999px; font-weight:700; font-size:0.85rem; background:rgba(255,255,255,0.05); border:1px solid var(--glass)}

    /* IKON HAPUS KECIL */
    .delete-btn {
        background: none;
        border: none;
        color: #ff7b92; /* Warna merah muda */
        cursor: pointer;
        padding: 4px; /* Padding minimal */
        font-size: 1rem; /* Ukuran ikon */
        transition: color 0.2s;
        margin-left: 10px; /* Jarak dari elemen sebelumnya */
    }
    .delete-btn:hover {
        color: #ff476e;
    }


    /* NOTIFIKASI */
    #notif{
        position:fixed; left:50%; top:20px; transform:translateX(-50%) translateY(-50px);
        transition:all .3s ease-out; z-index:60; min-width:320px;
        background:var(--card);
        display:none;
        box-shadow:var(--shadow);
        border:1px solid;
    }
    #notif.error { border-color: #ff7b92; color: #ff7b92; }
    #notif.success { border-color: #8ef0c1; color: #8ef0c1; }
    
    /* Responsive Helpers */
    .center{ text-align:center }
    .muted{color:var(--muted); font-size:0.9rem}
    .note{ font-size:0.86rem; color:var(--muted); margin-top:8px }

  </style>
</head>
<body>

  <div class="main-container">
    <div class="promo-strip">
      <div class="promo-text">
        ðŸ“¢ PROMO SPESIAL HARI INI:** Dapatkan diskon 20% untuk 10 pelanggan pertama! Cek layanan terbaru kami sekarang! | 
         Kualitas terjamin dan pengerjaan cepat. Ayo order sekarang juga! âœ¨
      </div>
    </div>
    
    <div class="wrap">
      <section class="card card-form" aria-labelledby="form-title">
        <h2 id="form-title">Berikan Feedback & Penilaian</h2>
        <p class="lead">Masukan Anda sangat berharga untuk peningkatan layanan kami.</p>

        <form id="feedbackForm" autocomplete="off" action="https://formspree.io/f/movkypgd" method="POST">
          <label for="name">Nama</label>
          <input id="name" name="name" type="text" placeholder="(opsional)">

          <label for="email" class="required">Email</label>
          <input id="email" name="_replyto" type="email" placeholder="contoh@mail.com" required>

          <label class="required">Rating</label>
          <div class="stars" id="stars" role="radiogroup" aria-label="Rating">
            <i class="fas fa-star star" data-value="1" role="radio" aria-checked="false" tabindex="0"></i>
            <i class="fas fa-star star" data-value="2" role="radio" aria-checked="false" tabindex="0"></i>
            <i class="fas fa-star star" data-value="3" role="radio" aria-checked="false" tabindex="0"></i>
            <i class="fas fa-star star" data-value="4" role="radio" aria-checked="false" tabindex="0"></i>
            <i class="fas fa-star star" data-value="5" role="radio" aria-checked="false" tabindex="0"></i>
          </div>
          <input type="hidden" name="rating" id="ratingInput" required>
          <div class="note small" id="ratingNote">Belum memilih rating</div>

          <label for="message">Komentar</label>
          <textarea id="message" name="message_body" placeholder="Apa pendapatmu?"></textarea>

          <div class="actions">
            <button class="primary" type="submit" id="sendBtn" data-original-text='<i class="fas fa-paper-plane"></i>&nbsp;Kirim Feedback'><i class="fas fa-paper-plane"></i>&nbsp;Kirim Feedback</button>
            <button class="ghost" type="button" id="clearLocal" title="Hanya menghapus feedback yang Anda buat di browser ini."><i class="fas fa-user-slash"></i> Hapus Feedback Anda</button>
          </div>

          <div class="note danger small" id="profanityWarning" style="display:none;margin-top:10px;">
            <i class="fas fa-exclamation-triangle"></i> Terdeteksi kata-kata yang dilarang. Mohon perbaiki.
          </div>
        </form>
      </section>

      <section class="card card-list-reviews">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:700">Daftar Feedback Terbaru</div>
          <div class="small muted">Terakhir dikirim muncul paling atas</div>
        </div>
        <div class="filter" style="margin-top:10px; display:flex; gap:8px; align-items:center;">
            <label class="small" style="margin:0;">Filter Rating</label>
            <select id="filterRating" style="padding:6px; border-radius:8px; background:var(--panel); color:var(--text); border:1px solid var(--glass); font-size:0.9rem;">
              <option value="all">Semua rating</option>
              <option value="5">Bintang 5</option>
              <option value="4">Bintang 4</option>
              <option value="3">Bintang 3</option>
              <option value="2">Bintang 2</option>
              <option value="1">Bintang 1</option>
            </select>
            <button class="ghost right" id="exportCsv" style="padding: 6px 12px;"><i class="fas fa-download"></i> Export CSV</button>
        </div>

        <div class="list" id="feedbackList" aria-live="polite"></div>
      </section>

      <aside class="sidebar">
        <div class="card">
          <div style="font-weight:800;font-size:1.05rem; margin-bottom: 10px;">Ringkasan Penilaian</div>

          <div class="stat-grid">
            <div class="stat">
              <div class="small">Rata-rata</div>
              <div class="value" id="avgRating">â€”</div>
              <div class="small muted">dari semua penilaian</div>
            </div>
            <div class="stat">
              <div class="small">Total</div>
              <div class="value" id="totalCount">0</div>
              <div class="small muted">responden</div>
            </div>
          </div>

          <div style="margin-top:15px">
            <canvas id="ratingChart" width="320" height="160"></canvas>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <div id="notif" class="card" style="position:fixed;left:50%;top:20px;transform:translateX(-50%) translateY(-50px);opacity:0;transition:all .3s ease-out;z-index:60;min-width:320px;display:none">
    <div id="notifText" class="center"></div>
  </div>

  <script>
  
  /* --------------------------
     CONFIG
     ---------------------------*/
  const FORMSPREE_ENDPOINT = 'https://formspree.io/f/movkypgd'; 
  const SENDER_KEY = 'ta_last_sender_email'; // Key untuk menyimpan email pengirim
  const STORAGE_KEY = 'ta_feedbacks_v3'; // Key baru
  /* --------------------------
     END CONFIG
     ---------------------------*/

  // DOM & Variables
  const stars = Array.from(document.querySelectorAll('.star'));
  const ratingNote = document.getElementById('ratingNote');
  const ratingInput = document.getElementById('ratingInput');
  const form = document.getElementById('feedbackForm');
  const feedbackList = document.getElementById('feedbackList');
  const avgRatingEl = document.getElementById('avgRating');
  const totalCountEl = document.getElementById('totalCount');
  const filterRating = document.getElementById('filterRating');
  const exportCsvBtn = document.getElementById('exportCsv');
  const clearLocalBtn = document.getElementById('clearLocal');
  const notif = document.getElementById('notif');
  const sendBtn = document.getElementById('sendBtn');
  const profanityWarning = document.getElementById('profanityWarning');
  const messageInput = document.getElementById('message');
  const emailInput = document.getElementById('email');

  const NEGATIVE_WORDS = [
    'judol', 'judi online', 'pinjol', 'pinjaman online', 'narkoba', 'ganja', 'kokain', 
    'heroin', 'sabu', 'extacy', 'porno', 'asusila', 'pelecehan', 'penipuan', 
    'scam', 'spam', 'cabul', 'mesum', 'pembunuhan', 'kekerasan', 'teror'
  ];

  let currentRating = 0;
  let senderEmail = localStorage.getItem(SENDER_KEY) || ''; // Ambil email pengirim terakhir

  // --- Utility Functions ---
  
  function readStorage(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      return raw ? JSON.parse(raw) : [];
    }catch(e){ return [] }
  }
  function writeStorage(arr){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
  }
  function escapeHtml(s){
    if(!s) return '';
    return s.replace(/[&<>"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));
  }
  function checkProfanity(text){
      if(!text) return false;
      const t = text.toLowerCase();
      return NEGATIVE_WORDS.some(word => {
        const regex = new RegExp(word.replace(/ /g, ' *'), 'i');
        return regex.test(t);
      });
  }

  // notifications
  let notifTimeout = null;
  function showNotif(text, isError = false){
    const notifText = document.getElementById('notifText');
    notifText.innerHTML = `<i class="fas ${isError ? 'fa-exclamation-circle' : 'fa-check-circle'}"></i> ${text}`;
    notif.className = isError ? 'card error' : 'card success';
    notif.style.display = 'block';
    notif.style.opacity = '1';
    notif.style.transform = 'translateX(-50%) translateY(0)';
    
    if(notifTimeout) clearTimeout(notifTimeout);
   notifTimeout = setTimeout(()=>{ notif.style.opacity = '0'; notif.style.transform='translateX(-50%) translateY(-50px)'; setTimeout(()=>notif.style.display='none',300); }, 3500);
  }

  // delete feedback (global)
  function deleteFeedback(id){
    const arr = readStorage().filter(x=> x.id !== id);
    writeStorage(arr);
    refreshUI();
    showNotif('Feedback dihapus dari lokal.');
  }
  window.deleteFeedback = deleteFeedback; // Expose to global scope for HTML onclick

  // --- UI Interactions ---

  // star interactions
  stars.forEach(s => {
    s.addEventListener('mouseover', ()=> highlightStars(Number(s.dataset.value)));
    s.addEventListener('mouseout', ()=> highlightStars(currentRating));
    s.addEventListener('click', ()=> {
      currentRating = Number(s.dataset.value);
      ratingNote.textContent = `Rating: ${currentRating} bintang`; 
      ratingInput.value = currentRating;
      highlightStars(currentRating);
    });
    s.addEventListener('keydown', (e)=> {
      if(e.key === 'Enter' || e.key === ' '){
        e.preventDefault();
        currentRating = Number(s.dataset.value);
        ratingNote.textContent = `Rating: ${currentRating} bintang`;
        ratingInput.value = currentRating;
        highlightStars(currentRating);
      }
    });
  });

  function highlightStars(n){
    stars.forEach(s => {
      const v = Number(s.dataset.value);
      s.classList.toggle('active', v <= n);
    });
  }

  messageInput.addEventListener('input', ()=>{
      profanityWarning.style.display = checkProfanity(messageInput.value) ? 'block' : 'none';
  });
  
  // Isi email terakhir jika ada di local storage
  if (senderEmail) {
      emailInput.value = senderEmail;
  }

  // --- Main Logic ---

  let chart = null;
  function refreshUI(){
    const all = readStorage().slice().reverse(); 
    const filter = filterRating.value;
    const filtered = filter === 'all' ? all : all.filter(x=> String(x.rating) === filter);

    // List
    feedbackList.innerHTML = '';
    if(filtered.length === 0){
      feedbackList.innerHTML = `<div class="muted small center" style="padding:12px">Belum ada feedback yang tampil.</div>`;
    }else{
      filtered.forEach((f)=>{
        const item = document.createElement('div'); item.className='item';
        const avatar = document.createElement('div'); avatar.className='avatar';
        avatar.textContent = (f.name && f.name.trim()[0]) ? f.name.trim()[0].toUpperCase() : f.email ? f.email[0].toUpperCase() : 'U';

        const meta = document.createElement('div'); meta.className='meta';
        const nameEl = document.createElement('div'); nameEl.className = 'name'; nameEl.textContent = escapeHtml(f.name || 'Anonim');
        const msgEl = document.createElement('div'); msgEl.className = 'msg'; msgEl.textContent = escapeHtml(f.message || '- (Tanpa Komentar) -');
        
        const controls = document.createElement('div'); controls.className='controls';
        const time = document.createElement('div'); time.className='small muted'; time.textContent = new Date(f.createdAt).toLocaleString('id-ID', {day: 'numeric', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit'});
        const ratingPill = document.createElement('div'); ratingPill.className='pill'; ratingPill.textContent=`${f.rating} â˜…`; ratingPill.style.marginLeft = 'auto';
        
        // Fitur HAPUS SELEKTIF
        const isSender = f.email.toLowerCase() === senderEmail.toLowerCase();
        
        if (isSender) {
            const del = document.createElement('button'); 
            del.className='delete-btn'; 
            del.innerHTML='<i class="fas fa-trash-alt"></i>'; 
            del.setAttribute('title', 'Hapus feedback ini dari tampilan browser Anda');
            del.addEventListener('click', ()=> {
              if(!confirm('Hapus feedback yang Anda buat ini dari tampilan browser?')) return;
              deleteFeedback(f.id);
            });
            controls.appendChild(time);
            controls.appendChild(ratingPill);
            controls.appendChild(del);
        } else {
            controls.appendChild(time);
            controls.appendChild(ratingPill);
        }

        meta.appendChild(nameEl);
        meta.appendChild(msgEl);
        
        item.appendChild(avatar); 
        item.appendChild(meta); 
        item.appendChild(controls);
        feedbackList.appendChild(item);
      });
    }

    // Stats & Chart Logic (Sama)
    const allRaw = readStorage();
    const total = allRaw.length;
    totalCountEl.textContent = total;

    const avg = total === 0 ? 0 : (allRaw.reduce((s,i)=> s + Number(i.rating || 0), 0) / total);
    avgRatingEl.textContent = total === 0 ? 'â€”' : avg.toFixed(2) + ' â˜…';

    const counts = [0,0,0,0,0];
    allRaw.forEach(f => {
      const r = Number(f.rating) || 0;
      if(r >=1 && r <=5) counts[r-1]++;
    });

    const ctx = document.getElementById('ratingChart').getContext('2d');
    const labels = ['1â˜…','2â˜…','3â˜…','4â˜…','5â˜…']; 
    const data = counts;
    if(chart) {
      chart.data.datasets[0].data = data;
      chart.update();
    } else {
      chart = new Chart(ctx, {
        type:'bar',
        data:{
          labels,
          datasets:[{
            label:'Jumlah responden',
            data,
            backgroundColor: ['#ff7b92','#ffb86b','#ffd86b','#b7f07a','#56e39f'],
            borderRadius:6
          }]
        },
        options:{
          plugins:{ legend:{display:false} },
          scales:{
            x:{ grid:{display:false} },
            y:{ beginAtZero:true, ticks:{precision:0} }
          },
          maintainAspectRatio: false,
          responsive: true
        }
      });
    }
  }

  // --- Form Submission ---
  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const name = form.name.value.trim();
    const email = form._replyto.value.trim();
    const message = form.message_body.value.trim();
    const rating = currentRating;
    
    // Validasi
    if(!email || !rating || rating < 1){
      showNotif('Email dan Rating wajib diisi.', true);
      return;
    }
    
    // Filter kata negatif
    if(checkProfanity(message)){
      showNotif('Komentar mengandung kata-kata yang dilarang. Mohon perbaiki.', true);
      profanityWarning.style.display = 'block';
      return;
    } else {
        profanityWarning.style.display = 'none';
    }

    // UPDATE SENDER EMAIL
    senderEmail = email; 
    localStorage.setItem(SENDER_KEY, senderEmail);

    // disable button
    sendBtn.disabled = true; sendBtn.textContent = 'Mengirim...';

    const formData = new FormData();
    formData.append('name', name || 'Anonim');
    formData.append('_replyto', email);
    formData.append('message_body', message || '-');
    formData.append('rating', String(rating));

    // Kirim via Formspree
    try {
        const response = await fetch(FORMSPREE_ENDPOINT, {
            method: 'POST',
            body: formData,
            headers: {
                'Accept': 'application/json'
            }
        });

        if(response.ok) {
            showNotif('Feedback berhasil dikirim.');
        } else {
            showNotif('Gagal mengirim via Formspree â€” tapi disimpan di browser Anda.', true);
        }

    } catch(err){
        console.error('Network or Formspree error', err);
        showNotif('Gagal mengirim via Formspree â€” tapi disimpan di browser Anda.', true);
    }
    
    // Selalu simpan lokal (untuk dashboard)
    const entry = {
      id: 'fb_' + Date.now() + '_' + Math.floor(Math.random()*9000),
      name, email, message, rating,
      image: null,
      createdAt: Date.now()
    };
    const arr = readStorage(); arr.push(entry); writeStorage(arr); refreshUI();


    // reset UI
    form.reset(); 
    currentRating = 0; highlightStars(0); ratingNote.textContent = 'Belum memilih rating'; ratingInput.value = '';
    emailInput.value = senderEmail; // Pertahankan email yang terakhir dikirim
    sendBtn.disabled = false; sendBtn.innerHTML = sendBtn.dataset.originalText;
  });

  // --- ACTIONS ---
  
  // Mengubah fungsi tombol "Bersihkan Lokal" menjadi menghapus feedback DARI PENGIRIM SAAT INI
  clearLocalBtn.addEventListener('click', ()=>{
      if (!senderEmail) {
          showNotif('Anda belum mengirim feedback, tidak ada yang bisa dihapus.', true);
          return;
      }
      
      if(!confirm(`Hapus semua feedback yang Anda kirim (${senderEmail}) dari tampilan browser ini?`)) return;
      
      const arr = readStorage().filter(x => x.email.toLowerCase() !== senderEmail.toLowerCase());
      writeStorage(arr);
      refreshUI();
      showNotif(`Semua feedback dari ${senderEmail} berhasil dihapus dari browser.`);
  });

  filterRating.addEventListener('change', refreshUI);
  exportCsvBtn.addEventListener('click', exportCsv);

  // Initial render
  refreshUI();
  </script>
</body>
</html>
